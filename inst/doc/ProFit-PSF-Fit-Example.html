<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Aaron Robotham" />

<meta name="date" content="2019-11-11" />

<title>ProFit: PSF Fitting Example</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">ProFit: PSF Fitting Example</h1>
<h4 class="author">Aaron Robotham</h4>
<h4 class="date">2019-11-11</h4>



<p>Get the latest version of <strong>ProFit</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(devtools)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">install_github</span>(<span class="st">'ICRAR/ProFit'</span>)</a></code></pre></div>
<p>First load the libraries we need:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(ProFit)</a></code></pre></div>
<div id="prepare-the-test-data" class="section level2">
<h2>Prepare the test data</h2>
<p>Next we load a table of data describing GAMA galaxies:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">data</span>(<span class="st">'ExampleInit'</span>, <span class="dt">package=</span><span class="st">&quot;ProFit&quot;</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">head</span>(ExampleInit, <span class="dv">10</span>)</a></code></pre></div>
<pre><code>##    CATAID sersic.xcen1 sersic.ycen1 sersic.mag1 sersic.mag2 sersic.re1
## 1  265769     122.8069      87.3328    17.08907    17.08907    8.71420
## 2  265911      84.8832      94.5951    16.83217    16.83217    7.05740
## 3  265940      80.3975      52.2173    18.04857    18.04857    5.96290
## 4  265943      53.7013      83.6956    17.70547    17.70547    6.42060
## 5  265981     148.8727     106.4069    16.85617    16.85617   11.00100
## 6  265986      78.1780      79.9999    18.97747    18.97747    6.80575
## 7  265985      51.3467      73.0023    19.03897    19.03897    5.77065
## 8  266033      66.0826      79.0872    17.39137    17.39137    6.25480
## 9  266035     105.1495      78.5289    18.18017    18.18017   11.38780
## 10 266105     264.8947     219.5667    15.45027    15.45027   36.68265
##    sersic.re2 sersic.nser1 sersic.ang2 sersic.axrat2
## 1     17.4284       3.4292    105.8498        0.1541
## 2     14.1148       4.3776    140.8191        0.4891
## 3     11.9258       4.6010    112.2746        0.4875
## 4     12.8412       4.5086    168.2385        0.4179
## 5     22.0020       2.9434     59.6690        0.2621
## 6     13.6115       2.0082    103.2134        0.0423
## 7     11.5413       2.7402      0.7028        0.5400
## 8     12.5096       4.9178     39.5336        0.3336
## 9     22.7756       2.9550     56.3237        0.6222
## 10    73.3653       3.9704     94.4409        0.3477</code></pre>
<p>Here we will use an SDSS example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">datasource=<span class="st">'SDSS'</span></a></code></pre></div>
<p>Now we can extract out the example files we have available for fitting by checking the contents of the directory containing the example FITS files:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">ExampleFiles=<span class="kw">list.files</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>,datasource,<span class="dt">package=</span><span class="st">&quot;ProFit&quot;</span>))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">ExampleIDs=<span class="kw">unlist</span>(<span class="kw">strsplit</span>(ExampleFiles[<span class="kw">grep</span>(<span class="st">'fitim'</span>,ExampleFiles)],<span class="st">'fitim.fits'</span>))</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">ExampleIDs</a></code></pre></div>
<pre><code>##  [1] &quot;G265911&quot; &quot;G265940&quot; &quot;G266033&quot; &quot;G266035&quot; &quot;G266662&quot; &quot;G267199&quot; &quot;G267489&quot;
##  [8] &quot;G267525&quot; &quot;G278109&quot; &quot;G279148&quot;</code></pre>
<p>There are 10 example galaxies included. Here we run example 1:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">useID=ExampleIDs[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">psf=<span class="kw">readFITS</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="kw">paste</span>(datasource,<span class="st">'/'</span>,useID,<span class="st">'psfim.fits'</span>,<span class="dt">sep=</span><span class="st">''</span>),<span class="dt">package=</span><span class="st">&quot;ProFit&quot;</span>))<span class="op">$</span>imDat</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">psf=psf<span class="op">/</span><span class="kw">sum</span>(psf)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">psfsigma=<span class="kw">sqrt</span>(<span class="kw">abs</span>(psf))<span class="op">/</span><span class="dv">200</span> <span class="co">#To get reasonable PSF errors</span></a></code></pre></div>
<p>We can check the image of the PSF wiht magimage:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">temp=<span class="kw">magimage</span>(psf,<span class="dt">lo=</span><span class="dv">0</span>,<span class="dt">hi=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">contour</span>(temp, <span class="dt">add=</span>T, <span class="dt">col=</span><span class="st">'red'</span>, <span class="dt">drawlabels=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p>To check the profile a few 1D plots can be useful:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">magplot</span>(psf[<span class="dv">13</span>,],<span class="dt">type=</span><span class="st">'l'</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">lines</span>(psf[<span class="dv">12</span>,],<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">'red'</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw">lines</span>(psf[<span class="dv">14</span>,],<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">'blue'</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="kw">lines</span>(psf[<span class="dv">11</span>,],<span class="dt">lty=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'red'</span>)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw">lines</span>(psf[<span class="dv">15</span>,],<span class="dt">lty=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'blue'</span>)</a></code></pre></div>
<p>The red and blue lines fall pretty much on top of each other, so there is not much ellipticity.</p>
</div>
<div id="setup-the-fitting-data-structures" class="section level2">
<h2>Setup the fitting data structures</h2>
<p>We can use ProFit to fit an analytic Moffat function to the PSF to properly characterise this.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">modellist=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  <span class="dt">moffat=</span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">    <span class="dt">xcen=</span><span class="kw">dim</span>(psf)[<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">    <span class="dt">ycen=</span><span class="kw">dim</span>(psf)[<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">    <span class="dt">mag=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">    <span class="dt">fwhm=</span><span class="fl">2.5</span>,</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">    <span class="dt">con=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">    <span class="dt">ang=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">    <span class="dt">axrat=</span><span class="fl">0.9</span>,</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">    <span class="dt">box=</span><span class="dv">0</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11">  )</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">)</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">modellist</a></code></pre></div>
<pre><code>## $moffat
## $moffat$xcen
## [1] 12.5
## 
## $moffat$ycen
## [1] 12.5
## 
## $moffat$mag
## [1] 0
## 
## $moffat$fwhm
## [1] 2.5
## 
## $moffat$con
## [1] 3
## 
## $moffat$ang
## [1] 0
## 
## $moffat$axrat
## [1] 0.9
## 
## $moffat$box
## [1] 0</code></pre>
<p>We can check what this default model looks like:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">psfmodel=<span class="kw">profitMakeModel</span>(modellist,<span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">25</span>))<span class="op">$</span>z</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">magimage</span>(psfmodel)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">magimage</span>(<span class="kw">abs</span>(psfmodel<span class="op">-</span>psf)<span class="op">/</span>psfmodel,<span class="dt">zlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a></code></pre></div>
<p>We will fit everything:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">tofit=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">  <span class="dt">moffat=</span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">    <span class="dt">xcen=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">    <span class="dt">ycen=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">    <span class="dt">mag=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">    <span class="dt">fwhm=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">    <span class="dt">con=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">    <span class="dt">ang=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">    <span class="dt">axrat=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">    <span class="dt">box=</span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11">  )</a>
<a class="sourceLine" id="cb15-12" data-line-number="12">)</a></code></pre></div>
<p>And choose sensible options for which parameters to fit in log-space:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">tolog=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">  <span class="dt">moffat=</span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">    <span class="dt">xcen=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">    <span class="dt">ycen=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">    <span class="dt">mag=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">    <span class="dt">fwhm=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">    <span class="dt">con=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">    <span class="dt">ang=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">    <span class="dt">axrat=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb16-10" data-line-number="10">    <span class="dt">box=</span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11">  )</a>
<a class="sourceLine" id="cb16-12" data-line-number="12">)</a></code></pre></div>
<p>The intervals will be generous:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">intervals=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">  <span class="dt">moffat=</span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">    <span class="dt">xcen=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">25</span>)),</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">    <span class="dt">ycen=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">25</span>)),</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">    <span class="dt">mag=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">    <span class="dt">fwhm=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb17-7" data-line-number="7">    <span class="dt">con=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">20</span>)),</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">    <span class="dt">ang=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">360</span>)),</a>
<a class="sourceLine" id="cb17-9" data-line-number="9">    <span class="dt">axrat=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb17-10" data-line-number="10">    <span class="dt">box=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb17-11" data-line-number="11">  )</a>
<a class="sourceLine" id="cb17-12" data-line-number="12">)</a></code></pre></div>
<p>Now setup the Data structure we need for fitting, where we will use Normal likelihoods:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">Data=<span class="kw">profitSetupData</span>(<span class="dt">image=</span>psf, <span class="dt">mask=</span>(psf<span class="op">==</span><span class="dv">0</span>), <span class="dt">sigma=</span>psfsigma, <span class="dt">modellist=</span>modellist, <span class="dt">tofit=</span>tofit, <span class="dt">tolog=</span>tolog, <span class="dt">intervals=</span>intervals, <span class="dt">magzero=</span><span class="dv">0</span>, <span class="dt">algo.func=</span><span class="st">'optim'</span>, <span class="dt">verbose=</span><span class="ot">TRUE</span>, <span class="dt">like.func=</span><span class="st">'norm'</span>)</a></code></pre></div>
<p>Check our rough model:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">profitLikeModel</span>(<span class="dt">parm=</span>Data<span class="op">$</span>init, <span class="dt">Data=</span>Data, <span class="dt">makeplots=</span><span class="ot">TRUE</span>, <span class="dt">plotchisq=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>The initial rough model for the SDSS does not look great- clearly the PSF is much rounder than we guessed.</p>
<p>To stop the guess-work we can now optimise the model with BFGS:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">optimfit=<span class="kw">optim</span>(Data<span class="op">$</span>init, profitLikeModel, <span class="dt">method=</span><span class="st">'BFGS'</span>, <span class="dt">Data=</span>Data, <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">fnscale=</span><span class="op">-</span><span class="dv">1</span>))</a></code></pre></div>
<p>Check the final result:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">profitLikeModel</span>(optimfit<span class="op">$</span>par, Data,<span class="dt">makeplots=</span><span class="ot">TRUE</span>, <span class="dt">plotchisq=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>You can go even further with a full MCMC fit (I can assure you that in this case it is not worth the effort, but run if you must!):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">Data<span class="op">$</span>algo.func=<span class="st">&quot;LD&quot;</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">LDfit=<span class="kw">LaplacesDemon</span>(profitLikeModel, <span class="dt">Initial.Values=</span>optimfit<span class="op">$</span>par, <span class="dt">Data=</span>Data,</a>
<a class="sourceLine" id="cb22-4" data-line-number="4">  <span class="dt">Iterations=</span><span class="fl">1e4</span>, <span class="dt">Algorithm=</span><span class="st">'CHARM'</span>, <span class="dt">Thinning=</span><span class="dv">1</span>, <span class="dt">Specs=</span><span class="kw">list</span>(<span class="dt">alpha.star=</span><span class="fl">0.44</span>))</a></code></pre></div>
<p>Check the final result:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">profitLikeModel</span>(LDfit<span class="op">$</span>Summary2[,<span class="dv">1</span>], Data,<span class="dt">makeplots=</span><span class="ot">TRUE</span>, <span class="dt">plotchisq=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>Since the full MCMC achieves the same fit (more or less) we will procede with the optim fit. In the resultant fit we see that the FWHM is given as ~3, which given the SDSS pixel scale (0.339 asec/pix) is ~1 asec, which is pretty good for SDSS imaging. The PSF is preferred as being close to an axial ratio ~1 (or ~0 in log-space). We do find significant boxiness, so the PSF is not actually perfectly circular. We can see this visually in fact:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">PSFmodellist=<span class="kw">profitRemakeModellist</span>(optimfit<span class="op">$</span>par, modellist, <span class="dt">tofit=</span>tofit, <span class="dt">tolog=</span>tolog, <span class="dt">intervals=</span>intervals)<span class="op">$</span>modellist</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">PSFmodellist<span class="op">$</span>moffat<span class="op">$</span>xcen=<span class="fl">12.5</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3">PSFmodellist<span class="op">$</span>moffat<span class="op">$</span>ycen=<span class="fl">12.5</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4">PSFmodellist<span class="op">$</span>moffat<span class="op">$</span>mag=<span class="dv">0</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5">psfmodel=<span class="kw">profitMakeModel</span>(PSFmodellist, <span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">25</span>))<span class="op">$</span>z</a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="kw">contour</span>(<span class="kw">magimage</span>(psfmodel), <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">'red'</span>, <span class="dt">drawlabels=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p>Notice in the above we set a few parameters to be exactly where we want, e.g. the PSF should be in the middle of our 25x25 image matrix (the fit was at 12.51 and 12.51 rather than 12.5 and 12.5) and the magnitude should be exactly 0 (i.e. the integral of the PSF sums to 1). We now have an analytic means of describing the SDSS PSF. We can use this for subsequent fitting.</p>
</div>
<div id="use-the-analytic-psf-to-fit-a-target-galaxy" class="section level2">
<h2>Use the analytic PSF to fit a target galaxy</h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">useID=ExampleIDs[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">image=<span class="kw">readFITS</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="kw">paste</span>(datasource,<span class="st">'/'</span>,useID,<span class="st">'fitim.fits'</span>,<span class="dt">sep=</span><span class="st">''</span>), <span class="dt">package=</span><span class="st">&quot;ProFit&quot;</span>))<span class="op">$</span>imDat</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">sigma=<span class="kw">readFITS</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="kw">paste</span>(datasource,<span class="st">'/'</span>,useID,<span class="st">'sigma.fits'</span>,<span class="dt">sep=</span><span class="st">''</span>), <span class="dt">package=</span><span class="st">&quot;ProFit&quot;</span>))<span class="op">$</span>imDat</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">segim=<span class="kw">readFITS</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="kw">paste</span>(datasource,<span class="st">'/'</span>,useID,<span class="st">'segim.fits'</span>,<span class="dt">sep=</span><span class="st">''</span>), <span class="dt">package=</span><span class="st">&quot;ProFit&quot;</span>))<span class="op">$</span>imDat</a></code></pre></div>
<p>Next we extract parameters for a very rough model (not meant to look too good yet):</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">useIDnum=<span class="kw">as.integer</span>(<span class="kw">strsplit</span>(useID,<span class="st">'G'</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">useloc=<span class="kw">which</span>(ExampleInit<span class="op">$</span>CATAID<span class="op">==</span>useIDnum)</a></code></pre></div>
</div>
<div id="setup-the-fitting-data-structures-1" class="section level2">
<h2>Setup the fitting data structures</h2>
<p>For our initial model we treat component 1 as the putative bulge and component 2 as the putative disk. We are going to attempt a fit where the disk is forced to have nser=1 and the bulge has an axial ratio of 1.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">modellist=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">  <span class="dt">sersic=</span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">    <span class="dt">xcen=</span> <span class="kw">c</span>(<span class="kw">dim</span>(image)[<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>, <span class="kw">dim</span>(image)[<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">    <span class="dt">ycen=</span> <span class="kw">c</span>(<span class="kw">dim</span>(image)[<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>, <span class="kw">dim</span>(image)[<span class="dv">2</span>]<span class="op">/</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb27-5" data-line-number="5">    <span class="dt">mag=</span> <span class="kw">c</span>(ExampleInit<span class="op">$</span>sersic.mag1[useloc], ExampleInit<span class="op">$</span>sersic.mag2[useloc]),</a>
<a class="sourceLine" id="cb27-6" data-line-number="6">    <span class="dt">re=</span> <span class="kw">c</span>(ExampleInit<span class="op">$</span>sersic.re1[useloc], ExampleInit<span class="op">$</span>sersic.re2[useloc])<span class="op">*</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="st">      </span><span class="cf">if</span>(datasource<span class="op">==</span><span class="st">'KiDS'</span>){<span class="dv">1</span>}<span class="cf">else</span>{<span class="fl">0.2</span><span class="op">/</span><span class="fl">0.339</span>},</a>
<a class="sourceLine" id="cb27-8" data-line-number="8">    <span class="dt">nser=</span> <span class="kw">c</span>(ExampleInit<span class="op">$</span>sersic.nser1[useloc], <span class="dv">1</span>),  <span class="co">#Disk is initially nser=1</span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9">    <span class="dt">ang=</span> <span class="kw">c</span>(ExampleInit<span class="op">$</span>sersic.ang2[useloc], ExampleInit<span class="op">$</span>sersic.ang2[useloc]),</a>
<a class="sourceLine" id="cb27-10" data-line-number="10">    <span class="dt">axrat=</span> <span class="kw">c</span>(<span class="dv">1</span>, ExampleInit<span class="op">$</span>sersic.axrat2[useloc]),  <span class="co">#Bulge is initially axrat=1</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11">    <span class="dt">box=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb27-12" data-line-number="12">  )</a>
<a class="sourceLine" id="cb27-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb27-14" data-line-number="14">modellist</a></code></pre></div>
<pre><code>## $sersic
## $sersic$xcen
## [1] 50.5 50.5
## 
## $sersic$ycen
## [1] 50.5 50.5
## 
## $sersic$mag
## [1] 16.83217 16.83217
## 
## $sersic$re
## [1] 4.163658 8.327316
## 
## $sersic$nser
## [1] 4.3776 1.0000
## 
## $sersic$ang
## [1] 140.8191 140.8191
## 
## $sersic$axrat
## [1] 1.0000 0.4891
## 
## $sersic$box
## [1] 0 0</code></pre>
<p>The pure model (no PSF):</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">magimage</span>(<span class="kw">profitMakeModel</span>(modellist,<span class="dt">dim=</span><span class="kw">dim</span>(image)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The original image:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">magimage</span>(image)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The convolved model (with PSF):</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">magimage</span>(<span class="kw">profitMakeModel</span>(modellist,<span class="dt">dim=</span><span class="kw">dim</span>(image),<span class="dt">psf=</span>psfmodel))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Next we define our list of what we want to fit (where TRUE means we will fit it later):</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">tofit=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">  <span class="dt">sersic=</span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb32-3" data-line-number="3">    <span class="dt">xcen=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">NA</span>), <span class="co">#We fit for xcen and tie the two togther</span></a>
<a class="sourceLine" id="cb32-4" data-line-number="4">    <span class="dt">ycen=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">NA</span>), <span class="co">#We fit for ycen and tie the two togther</span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5">    <span class="dt">mag=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="co">#Fit for both</span></a>
<a class="sourceLine" id="cb32-6" data-line-number="6">    <span class="dt">re=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="co">#Fit for both</span></a>
<a class="sourceLine" id="cb32-7" data-line-number="7">    <span class="dt">nser=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>), <span class="co">#Fit for bulge</span></a>
<a class="sourceLine" id="cb32-8" data-line-number="8">    <span class="dt">ang=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">TRUE</span>), <span class="co">#Fit for disk</span></a>
<a class="sourceLine" id="cb32-9" data-line-number="9">    <span class="dt">axrat=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">TRUE</span>), <span class="co">#Fit for disk</span></a>
<a class="sourceLine" id="cb32-10" data-line-number="10">    <span class="dt">box=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>) <span class="co">#Fit for neither</span></a>
<a class="sourceLine" id="cb32-11" data-line-number="11">  )</a>
<a class="sourceLine" id="cb32-12" data-line-number="12">)</a></code></pre></div>
<p>Now we define what parameters should be fitted in log space:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">tolog=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb33-2" data-line-number="2">  <span class="dt">sersic=</span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb33-3" data-line-number="3">    <span class="dt">xcen=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb33-4" data-line-number="4">    <span class="dt">ycen=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb33-5" data-line-number="5">    <span class="dt">mag=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb33-6" data-line-number="6">    <span class="dt">re=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="co">#re is best fit in log space</span></a>
<a class="sourceLine" id="cb33-7" data-line-number="7">    <span class="dt">nser=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="co">#nser is best fit in log space</span></a>
<a class="sourceLine" id="cb33-8" data-line-number="8">    <span class="dt">ang=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb33-9" data-line-number="9">    <span class="dt">axrat=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="co">#axrat is best fit in log space</span></a>
<a class="sourceLine" id="cb33-10" data-line-number="10">    <span class="dt">box=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb33-11" data-line-number="11">  )</a>
<a class="sourceLine" id="cb33-12" data-line-number="12">)</a></code></pre></div>
<p>The hard intervals should also be specified in linear space:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">intervals=<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">  <span class="dt">sersic=</span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">    <span class="dt">xcen=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">300</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">300</span>)),</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">    <span class="dt">ycen=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">300</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">300</span>)),</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">    <span class="dt">mag=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">30</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">30</span>)),</a>
<a class="sourceLine" id="cb34-6" data-line-number="6">    <span class="dt">re=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)),</a>
<a class="sourceLine" id="cb34-7" data-line-number="7">    <span class="dt">nser=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">20</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">20</span>)),</a>
<a class="sourceLine" id="cb34-8" data-line-number="8">    <span class="dt">ang=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">360</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">360</span>)),</a>
<a class="sourceLine" id="cb34-9" data-line-number="9">    <span class="dt">axrat=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb34-10" data-line-number="10">    <span class="dt">box=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb34-11" data-line-number="11">  )</a>
<a class="sourceLine" id="cb34-12" data-line-number="12">)</a></code></pre></div>
<p>Setup the data structure we need for optimisation, taking a few seconds to find the optimal convolution method:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">Data=<span class="kw">profitSetupData</span>(<span class="dt">image=</span>image, <span class="dt">sigma=</span>sigma, <span class="dt">segim=</span>segim, <span class="dt">psf=</span>psfmodel,</a>
<a class="sourceLine" id="cb35-2" data-line-number="2">                     <span class="dt">modellist=</span>modellist, <span class="dt">tofit=</span>tofit, <span class="dt">tolog=</span>tolog, <span class="dt">intervals=</span>intervals,</a>
<a class="sourceLine" id="cb35-3" data-line-number="3">                     <span class="dt">magzero=</span><span class="dv">0</span>, <span class="dt">algo.func=</span><span class="st">'optim'</span>, <span class="dt">like.func=</span><span class="st">&quot;t&quot;</span>, <span class="dt">verbose=</span><span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="do-some-fitting-with-the-new-model-psf" class="section level2">
<h2>Do some fitting with the new model PSF:</h2>
<p>We will try <code>optim</code> BFGS:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">optimfitMod=<span class="kw">optim</span>(Data<span class="op">$</span>init, profitLikeModel, <span class="dt">method=</span><span class="st">'BFGS'</span>, <span class="dt">Data=</span>Data,</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">                  <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">fnscale=</span><span class="op">-</span><span class="dv">1</span>))</a></code></pre></div>
<p>The best <code>optim</code> BFGS fit is given by:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">optimfitMod<span class="op">$</span>par</a></code></pre></div>
<p>Check it out:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">profitLikeModel</span>(optimfitMod<span class="op">$</span>par,Data,<span class="dt">makeplots=</span><span class="ot">TRUE</span>,<span class="dt">whichcomponents=</span><span class="kw">list</span>(<span class="dt">sersic=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="kw">profitLikeModel</span>(optimfitMod<span class="op">$</span>par,Data,<span class="dt">makeplots=</span><span class="ot">TRUE</span>,<span class="dt">whichcomponents=</span><span class="kw">list</span>(<span class="dt">sersic=</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="kw">profitLikeModel</span>(optimfitMod<span class="op">$</span>par,Data,<span class="dt">makeplots=</span><span class="ot">TRUE</span>,<span class="dt">whichcomponents=</span><span class="kw">list</span>(<span class="dt">sersic=</span><span class="st">'all'</span>))</a></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">modeloptim=<span class="kw">profitRemakeModellist</span>(optimfitMod<span class="op">$</span>par,Data<span class="op">$</span>modellist,Data<span class="op">$</span>tofit,Data<span class="op">$</span>tolog)<span class="op">$</span>modellist</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="kw">profitEllipsePlot</span>(Data,modeloptim,<span class="dt">pixscale=</span><span class="fl">0.339</span>,<span class="dt">FWHM=</span><span class="dv">1</span>,<span class="dt">SBlim=</span><span class="dv">26</span>)</a></code></pre></div>
<p>Now we can try the empirical PSF instead (for comparison):</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">Data=<span class="kw">profitSetupData</span>(<span class="dt">image=</span>image, <span class="dt">sigma=</span>sigma, <span class="dt">segim=</span>segim, <span class="dt">psf=</span>psf,</a>
<a class="sourceLine" id="cb40-2" data-line-number="2">  <span class="dt">modellist=</span>modellist, <span class="dt">tofit=</span>tofit, <span class="dt">tolog=</span>tolog, <span class="dt">intervals=</span>intervals, <span class="dt">magzero=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb40-3" data-line-number="3">  <span class="dt">algo.func=</span><span class="st">'optim'</span>, <span class="dt">like.func=</span><span class="st">&quot;t&quot;</span>, <span class="dt">verbose=</span><span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="do-some-fitting-with-the-empirical-model-psf" class="section level2">
<h2>Do some fitting with the empirical model PSF:</h2>
<p>We will try <code>optim</code> BFGS:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">optimfitEmp=<span class="kw">optim</span>(Data<span class="op">$</span>init, profitLikeModel, <span class="dt">method=</span><span class="st">'BFGS'</span>, <span class="dt">Data=</span>Data,</a>
<a class="sourceLine" id="cb41-2" data-line-number="2">                  <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">fnscale=</span><span class="op">-</span><span class="dv">1</span>))</a></code></pre></div>
<p>The best <code>optim</code> L-BFGS-B fit is given by:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">optimfitEmp<span class="op">$</span>par</a></code></pre></div>
<p>Check it out:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">profitLikeModel</span>(optimfitEmp<span class="op">$</span>par,Data,<span class="dt">makeplots=</span><span class="ot">TRUE</span>,<span class="dt">whichcomponents=</span><span class="kw">list</span>(<span class="dt">sersic=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="kw">profitLikeModel</span>(optimfitEmp<span class="op">$</span>par,Data,<span class="dt">makeplots=</span><span class="ot">TRUE</span>,<span class="dt">whichcomponents=</span><span class="kw">list</span>(<span class="dt">sersic=</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="kw">profitLikeModel</span>(optimfitEmp<span class="op">$</span>par,Data,<span class="dt">makeplots=</span><span class="ot">TRUE</span>,<span class="dt">whichcomponents=</span><span class="kw">list</span>(<span class="dt">sersic=</span><span class="st">'all'</span>))</a></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">modeloptim=<span class="kw">profitRemakeModellist</span>(optimfitEmp<span class="op">$</span>par,Data<span class="op">$</span>modellist,Data<span class="op">$</span>tofit,Data<span class="op">$</span>tolog)<span class="op">$</span>modellist</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="kw">profitEllipsePlot</span>(Data,modeloptim,<span class="dt">pixscale=</span><span class="fl">0.339</span>,<span class="dt">FWHM=</span><span class="dv">1</span>,<span class="dt">SBlim=</span><span class="dv">26</span>)</a></code></pre></div>
<p>Fitting using the empirical PSF gives similar results and best-fit LL (slightly better LL), but a larger bulge Re and a brighter bulge magnitude. It makes sense the model versus empirical PSF would disagree most for bulge parameters- these are dominated by the core region where the resolution is barely above the PSF itself.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
