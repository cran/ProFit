<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Aaron Robotham" />

<meta name="date" content="2018-11-28" />

<title>ProFit/ProFound: The Full Monty</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">ProFit/ProFound: The Full Monty</h1>
<h4 class="author"><em>Aaron Robotham</em></h4>
<h4 class="date"><em>2018-11-28</em></h4>



<p>Get the latest version of <strong>ProFound</strong> and <strong>ProFit</strong>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">install_github</span>(<span class="st">'asgr/ProFound'</span>)
<span class="kw">install_github</span>(<span class="st">'ICRAR/ProFit'</span>)</code></pre></div>
<p>Set global evaluate (basically TRUE for GitHub version and FALSE for CRAN):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">evalglobal=<span class="ot">FALSE</span></code></pre></div>
<p>First load the libraries we need:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ProFit)
<span class="kw">library</span>(ProFound)
<span class="kw">library</span>(RColorBrewer)</code></pre></div>
<p>So, you want to profile a galaxy, and you have next to no information about it. Well with <strong>ProFit</strong> no segmentation map, no sigma map, no PSF, no gain and no sky subtraction is (almost) no problem. Thanks to a number of utility functions we can achieve a reasonable fit bootstrapping directly from the data.</p>
<p>As an example, our mystery data will also be in a fairly crowded region, which will either require good (and conservative) image segmentation, or multiple object fitting.</p>
<p>First load the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">image=<span class="kw">readFITS</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">'VIKING/mystery_VIKING_Z.fits'</span>, <span class="dt">package=</span><span class="st">&quot;ProFound&quot;</span>))<span class="op">$</span>imDat</code></pre></div>
<p>And take a look at what we have got:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">magimage</span>(image, <span class="dt">hicut=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It is Z-band data from the VIKING survey, and in the second image it is possible to see that the bright source close to our spiral galaxy of interest in the centre is in fact two very bright stars.</p>
<div id="making-inputs-for-profit" class="section level2">
<h2>Making Inputs for ProFit</h2>
<p>The first thing to do is to create an object segmentation of the full image. Here we input the known magnitude zero-point for this frame (30), and the pixel scale for VISTA VIRCAM (0.34 asec/pix). If these are not provided then outputs would be in terms on ADUs and pixels rather than AB mag and asec.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">segim=<span class="kw">profoundMakeSegim</span>(image, <span class="dt">magzero=</span><span class="dv">30</span>, <span class="dt">pixscale=</span><span class="fl">0.34</span>, <span class="dt">plot=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>This is a pretty decent start, and it has identified all the main sources of interest. We can look at the object information in the attached table:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(segim<span class="op">$</span>segstats)</code></pre></div>
<p>The output is approximately in descending flux order. This data happened to have a mag-zero point of 30, so we can extract approximate magnitudes already. Our object of interest is the galaxy near the centre of the frame (178,178), so we already have approximate parameter properties for fitting purposes. E.g. the magnitude to start with is going to be close to 18.55 (notice since we provided a magzero argument before the flux is given in magnitudes already). This number will be useful later.</p>
<p>The next step is to expand out the segmantation for our target galaxy. this is a good idea because we want our model fit to descend into sky dominated pixels and not to be tightly defined by bright central pixels:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">segim_expand=<span class="kw">profoundMakeSegimExpand</span>(image, segim<span class="op">$</span>segim, <span class="dt">expand=</span><span class="dv">6</span>, <span class="dt">expandsigma=</span><span class="dv">3</span>, <span class="dt">skycut=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">magzero=</span><span class="dv">30</span>, <span class="dt">pixscale=</span><span class="fl">0.34</span>, <span class="dt">rotstats=</span><span class="ot">TRUE</span>, <span class="dt">plot=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>Notice because we set expand=6 only our object of interest (with segID=6) has been expanded. The other sources are left as they were.</p>
<p>We can use this output to calculate an approximate sky surface brightness limit (taken as being the RMS of the sky):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SBlim=<span class="kw">profitFlux2SB</span>(segim_expand<span class="op">$</span>skyRMS, <span class="dt">magzero=</span><span class="dv">30</span>, <span class="dt">pixscale=</span><span class="fl">0.34</span>)
<span class="kw">print</span>(SBlim)</code></pre></div>
<p>Given this segmentation we can look at some statistics on our apparent sky pixels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">object_frac=<span class="kw">length</span>(<span class="kw">which</span>(segim_expand<span class="op">$</span>objects<span class="op">==</span><span class="dv">1</span>))<span class="op">/</span><span class="kw">length</span>(image)
<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>object_frac)</code></pre></div>
<p>The above tells us that at a skycut level of ~1.4 is the point where we would expect 50% of pixels to be False-Positive (i.e.Â positive sky fluctuations) rather than True-Positives (associated with real sources). If we cut higher than this then most of our pixels at the surface brightness threshold will be real.</p>
<p>It is also instructive to make the <strong>qqplot</strong> of sky pixels:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">temp=<span class="kw">qqnorm</span>(<span class="kw">sort</span>((image[segim_expand<span class="op">$</span>objects<span class="op">==</span><span class="dv">0</span>]<span class="op">-</span>segim_expand<span class="op">$</span>sky)<span class="op">/</span>segim_expand<span class="op">$</span>skyRMS), <span class="dt">plot.it =</span> <span class="ot">FALSE</span>)
<span class="kw">magplot</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>), <span class="dt">grid=</span><span class="ot">TRUE</span>, <span class="dt">type=</span><span class="st">'n'</span>, <span class="dt">xlab=</span><span class="st">'Normal Quantile'</span>, <span class="dt">ylab=</span><span class="st">'Sky Pixel Quantile'</span>)
<span class="kw">lines</span>(temp)
<span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">'red'</span>)</code></pre></div>
<p>As we should hope, the <strong>qqplot</strong> crosses at very close to [0,0], but we can see evidence of a sytematic excess for positive flux in our sky pixels. This is to be expected- the Universe contains only positive sources (resolved or not, faint or bright) so if we have Normal statistics to the negative side, we should always see an excess on the positive side. Given this nature of the astrophysical sky, we look to have recovered the absolute sky and RMS of the sky to within a few percent (try perturbing the sky and skyRMS values to see how this affects the <strong>qqplot</strong>).</p>
<p>Now we have a decent segmentation we can estimate the image gain and the sigma map:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gain=<span class="kw">profoundGainEst</span>(image,<span class="dt">objects=</span>segim_expand<span class="op">$</span>objects, <span class="dt">sky=</span>segim_expand<span class="op">$</span>sky, <span class="dt">skyRMS=</span>segim_expand<span class="op">$</span>skyRMS)
gain</code></pre></div>
<p>The number found is ~0.5. Since the gain estimation routine is typically accurate to a factor of a few, it is quite likely that the image is already in photo-electron counts (i.e.Â gain=1), but we will continue with our lower estimate regardless.</p>
<p>Now we have the segmentation, sky estimates and the gain, we can make a sgima map:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sigma=<span class="kw">profoundMakeSigma</span>(image, <span class="dt">objects=</span>segim_expand<span class="op">$</span>objects, <span class="dt">gain=</span>gain, <span class="dt">sky=</span>segim_expand<span class="op">$</span>sky, <span class="dt">skyRMS =</span>segim_expand<span class="op">$</span>skyRMS, <span class="dt">plot=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>The sigma map will look much liek our original image, but with sky pixels set to a fixed value of uncertainty, and object pixels having an additional component of shot-noise.</p>
<div id="a-simple-psf-fit" class="section level3">
<h3>A Simple PSF Fit</h3>
<p>Next we want to find the PSF for fitting, so we should extract a a bright but non-saturated star from the list above:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">magplot</span>(segim_expand<span class="op">$</span>segstats<span class="op">$</span>R50, segim_expand<span class="op">$</span>segstats<span class="op">$</span>con,<span class="dt">log=</span><span class="st">'x'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">col=</span><span class="kw">hsv</span>(<span class="kw">magmap</span>(segim_expand<span class="op">$</span>segstats<span class="op">$</span>axrat, <span class="dt">flip=</span><span class="ot">TRUE</span>)<span class="op">$</span>map), <span class="dt">xlab=</span><span class="st">'Major Axis / pix'</span>, <span class="dt">ylab=</span><span class="st">'Concentration'</span>)
<span class="kw">magbar</span>(<span class="st">'topleft'</span>, <span class="dt">title=</span><span class="st">'Axrat'</span>, <span class="dt">titleshift=</span><span class="dv">1</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.65</span>), <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">c</span>(<span class="fl">0.7</span>,<span class="fl">1.2</span>), <span class="dt">lty=</span><span class="dv">2</span>)

<span class="kw">magplot</span>(segim_expand<span class="op">$</span>segstats<span class="op">$</span>SB_N50, segim_expand<span class="op">$</span>segstats<span class="op">$</span>con, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">col=</span><span class="kw">hsv</span>(<span class="kw">magmap</span>(segim_expand<span class="op">$</span>segstats<span class="op">$</span>axrat, <span class="dt">flip=</span><span class="ot">TRUE</span>)<span class="op">$</span>map), <span class="dt">xlab=</span><span class="st">'SB[50] / mag/asec^2'</span>, <span class="dt">ylab=</span><span class="st">'Concentration'</span>, <span class="dt">grid=</span><span class="ot">TRUE</span>)
<span class="kw">magbar</span>(<span class="st">'topleft'</span>, <span class="dt">title=</span><span class="st">'Axrat'</span>, <span class="dt">titleshift=</span><span class="dv">1</span>)
<span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">c</span>(<span class="fl">23.5</span>,<span class="dv">2</span>), <span class="dt">lty=</span><span class="dv">2</span>)

<span class="kw">magplot</span>( segim_expand<span class="op">$</span>segstats<span class="op">$</span>asymm, segim_expand<span class="op">$</span>segstats<span class="op">$</span>con, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">col=</span><span class="kw">hsv</span>(<span class="kw">magmap</span>(segim_expand<span class="op">$</span>segstats<span class="op">$</span>axrat, <span class="dt">flip=</span><span class="ot">TRUE</span>)<span class="op">$</span>map), <span class="dt">xlab=</span><span class="st">'Asymmetry'</span>, <span class="dt">ylab=</span><span class="st">'Concentration'</span>, <span class="dt">grid=</span><span class="ot">TRUE</span>)
<span class="kw">magbar</span>(<span class="st">'topleft'</span>, <span class="dt">title=</span><span class="st">'Axrat'</span>, <span class="dt">titleshift=</span><span class="dv">1</span>)
<span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">c</span>(<span class="fl">0.4</span>), <span class="dt">lty=</span><span class="dv">2</span>)</code></pre></div>
<p>We want to extract very red (axial ratio ~ 1) stars from the above region contained by the horizontal and vertical dashed lines:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">starlist=segim_expand<span class="op">$</span>segstats[segim_expand<span class="op">$</span>segstats<span class="op">$</span>axrat<span class="op">&gt;</span><span class="fl">0.9</span> <span class="op">&amp;</span><span class="st"> </span>segim_expand<span class="op">$</span>segstats<span class="op">$</span>con<span class="op">&gt;</span><span class="fl">0.4</span> <span class="op">&amp;</span><span class="st"> </span>segim_expand<span class="op">$</span>segstats<span class="op">$</span>con<span class="op">&lt;</span><span class="fl">0.65</span> <span class="op">&amp;</span><span class="st"> </span>segim_expand<span class="op">$</span>segstats<span class="op">$</span>R50<span class="op">&gt;</span><span class="fl">0.7</span> <span class="op">&amp;</span><span class="st"> </span>segim_expand<span class="op">$</span>segstats<span class="op">$</span>R50<span class="op">&lt;</span><span class="fl">1.2</span> <span class="op">&amp;</span><span class="st"> </span>segim_expand<span class="op">$</span>segstats<span class="op">$</span>SB_N50<span class="op">&lt;</span><span class="fl">23.5</span> <span class="op">&amp;</span><span class="st"> </span>segim_expand<span class="op">$</span>segstats<span class="op">$</span>asymm<span class="op">&lt;</span><span class="fl">0.2</span>,]
<span class="kw">print</span>(starlist)</code></pre></div>
<p>There are 5 sensible looking options it seems. We can extract the brightest of these likely stars to do our rough PSF estimate. When doing this in anger you might want to consider fitting all 5 stars (or however many make it through the selection cuts above). This gives you a way to marginalise over the uncertainty in the PSF (I discuss PSF uncertainty in some more detail at the end of this vignette).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psf_image=<span class="kw">magcutout</span>(image, <span class="dt">loc=</span>starlist[<span class="dv">1</span>,<span class="kw">c</span>(<span class="st">'xcen'</span>,<span class="st">'ycen'</span>)], <span class="dt">box=</span><span class="kw">c</span>(<span class="dv">31</span>,<span class="dv">31</span>))
psf_sigma=<span class="kw">magcutout</span>(sigma, <span class="dt">loc=</span>starlist[<span class="dv">1</span>,<span class="kw">c</span>(<span class="st">'xcen'</span>,<span class="st">'ycen'</span>)], <span class="dt">box=</span><span class="kw">c</span>(<span class="dv">31</span>,<span class="dv">31</span>))
psf_segim=<span class="kw">magcutout</span>(segim_expand<span class="op">$</span>segim, <span class="dt">loc=</span>starlist[<span class="dv">1</span>,<span class="kw">c</span>(<span class="st">'xcen'</span>,<span class="st">'ycen'</span>)], <span class="dt">box=</span><span class="kw">c</span>(<span class="dv">31</span>,<span class="dv">31</span>))</code></pre></div>
<p>Look at our target star to check we are happy:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">magimage</span>(psf_image<span class="op">$</span>image)
<span class="kw">magimage</span>(psf_sigma<span class="op">$</span>image)
<span class="kw">magimage</span>(psf_segim<span class="op">$</span>image)</code></pre></div>
<p>Next we make our initial model, where we take our PSF estimates from the segmentation stats:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psf_x=psf_image<span class="op">$</span>loc[<span class="dv">1</span>]
psf_y=psf_image<span class="op">$</span>loc[<span class="dv">2</span>]
psf_mag=starlist[<span class="dv">1</span>,<span class="st">'mag'</span>]
psf_fwhm=starlist[<span class="dv">1</span>,<span class="st">'R50'</span>]<span class="op">*</span><span class="dv">2</span><span class="op">/</span><span class="fl">0.339</span>
psf_con=<span class="dv">1</span><span class="op">/</span>starlist[<span class="dv">1</span>,<span class="st">'con'</span>]

psf_modellist=<span class="kw">list</span>(
  <span class="dt">moffat=</span><span class="kw">list</span>(
    <span class="dt">xcen=</span>psf_x,
    <span class="dt">ycen=</span>psf_y,
    <span class="dt">mag=</span>psf_mag,
    <span class="dt">fwhm=</span>psf_fwhm,
    <span class="dt">con=</span>psf_con,
    <span class="dt">axrat=</span><span class="dv">1</span>,
    <span class="dt">box=</span><span class="dv">0</span>
  )
)</code></pre></div>
<p>We also need to set up the tofit, tolog and intervals structure</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psf_tofit=<span class="kw">list</span>(
  <span class="dt">moffat=</span><span class="kw">list</span>(
    <span class="dt">xcen=</span><span class="ot">TRUE</span>,
    <span class="dt">ycen=</span><span class="ot">TRUE</span>,
    <span class="dt">mag=</span><span class="ot">TRUE</span>,
    <span class="dt">fwhm=</span><span class="ot">TRUE</span>,
    <span class="dt">con=</span><span class="ot">TRUE</span>,
    <span class="dt">axrat=</span><span class="ot">FALSE</span>,
    <span class="dt">box=</span><span class="ot">FALSE</span>
  )
)

psf_tolog=<span class="kw">list</span>(
  <span class="dt">moffat=</span><span class="kw">list</span>(
    <span class="dt">xcen=</span><span class="ot">FALSE</span>,
    <span class="dt">ycen=</span><span class="ot">FALSE</span>,
    <span class="dt">mag=</span><span class="ot">FALSE</span>,
    <span class="dt">fwhm=</span><span class="ot">TRUE</span>,
    <span class="dt">con=</span><span class="ot">TRUE</span>,
    <span class="dt">axrat=</span><span class="ot">FALSE</span>,
    <span class="dt">box=</span><span class="ot">FALSE</span>
  )
)

psf_intervals=<span class="kw">list</span>(
  <span class="dt">moffat=</span><span class="kw">list</span>(
    <span class="dt">xcen=</span><span class="kw">list</span>(psf_x<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>)),
    <span class="dt">ycen=</span><span class="kw">list</span>(psf_y<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>)),
    <span class="dt">mag=</span><span class="kw">list</span>(psf_mag<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)),
    <span class="dt">fwhm=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>)),
    <span class="dt">con=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>)),
    <span class="dt">axrat=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>)),
    <span class="dt">box=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))
  )
)</code></pre></div>
<p>Since there are no other sources in the frame we can use the full <strong>psf_image</strong> to attempt our profile fit (so no need to provide <strong>psf_segim</strong>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psf_Data=<span class="kw">profitSetupData</span>(psf_image<span class="op">$</span>image, <span class="dt">sigma=</span>psf_sigma<span class="op">$</span>image, <span class="dt">modellist=</span>psf_modellist, <span class="dt">tofit=</span>psf_tofit, <span class="dt">tolog=</span>psf_tolog, <span class="dt">magzero=</span><span class="dv">30</span>, <span class="dt">algo.func=</span><span class="st">'optim'</span>, <span class="dt">intervals=</span>psf_intervals)</code></pre></div>
<p>We can check our initial guess easily:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">profitLikeModel</span>(<span class="dt">parm=</span>psf_Data<span class="op">$</span>init, <span class="dt">Data=</span>psf_Data, <span class="dt">makeplots=</span><span class="ot">TRUE</span>, <span class="dt">plotchisq=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>Not bad, but not perfect. We can do an optim fit to improve things:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psf_fit=<span class="kw">optim</span>(psf_Data<span class="op">$</span>init, profitLikeModel, <span class="dt">method=</span><span class="st">'BFGS'</span>, <span class="dt">Data=</span>psf_Data, <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">fnscale=</span><span class="op">-</span><span class="dv">1</span>))</code></pre></div>
<p>Now we plot the output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">profitLikeModel</span>(<span class="dt">parm=</span>psf_fit<span class="op">$</span>par, <span class="dt">Data=</span>psf_Data, <span class="dt">makeplots=</span><span class="ot">TRUE</span>, <span class="dt">plotchisq=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>This looks like a very good fit. We will now contruct our model PSF:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psf_modellist_fit=<span class="kw">profitRemakeModellist</span>(<span class="dt">parm=</span>psf_fit<span class="op">$</span>par, <span class="dt">Data=</span>psf_Data)<span class="op">$</span>modellist
psf_modellist_fit<span class="op">$</span>moffat<span class="op">$</span>xcen=<span class="dv">25</span><span class="op">/</span><span class="dv">2</span>
psf_modellist_fit<span class="op">$</span>moffat<span class="op">$</span>ycen=<span class="dv">25</span><span class="op">/</span><span class="dv">2</span>
psf_model=<span class="kw">profitMakeModel</span>(<span class="dt">modellist=</span>psf_modellist_fit, <span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">25</span>))<span class="op">$</span>z</code></pre></div>
<p>And now we can look at our final PSF model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">magimage</span>(psf_model)</code></pre></div>
<p>Now we have all the key bits we need in order to fit our target galaxy!</p>
</div>
<div id="an-advanced-psf-fit" class="section level3">
<h3>An Advanced PSF Fit</h3>
<p>A more complicated alternative is to fit all the good stars (5 in this case) with the same profile simultaneously. Basically we have 5 PSFs distributed around our image, but we want to fit them all with the same PSF, modulo different xcen, ycen and mag:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psf_x=starlist<span class="op">$</span>xcen
psf_y=starlist<span class="op">$</span>ycen
psf_mag=starlist<span class="op">$</span>mag
psf_fwhm=starlist[<span class="dv">1</span>,<span class="st">'R50'</span>]<span class="op">*</span><span class="dv">2</span><span class="op">/</span><span class="fl">0.339</span>
psf_con=<span class="dv">1</span><span class="op">/</span>starlist[<span class="dv">1</span>,<span class="st">'con'</span>]

psf_modellist2=<span class="kw">list</span>(
  <span class="dt">pointsource =</span> <span class="kw">list</span>(
    <span class="dt">xcen =</span> psf_x,
    <span class="dt">ycen =</span> psf_y,
    <span class="dt">mag =</span> psf_mag
  ),
  <span class="dt">psf=</span><span class="kw">list</span>(
    <span class="dt">moffat=</span><span class="kw">list</span>(
      <span class="dt">mag=</span><span class="dv">0</span>,
      <span class="dt">fwhm=</span>psf_fwhm,
      <span class="dt">con=</span>psf_con,
      <span class="dt">axrat=</span><span class="dv">1</span>,
      <span class="dt">box=</span><span class="dv">0</span>
    )
  )
)</code></pre></div>
<p>We need to make our own region map since our object to fit will not be centrally located. First we should expand our segments of interest (not always vital- it depends whether you think there is much PSF flux hidden in broad wings or not):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">segim_expand_psf=<span class="kw">profoundMakeSegimExpand</span>(image, segim<span class="op">$</span>segim, <span class="dt">expand=</span>starlist<span class="op">$</span>segID, <span class="dt">expandsigma=</span><span class="dv">3</span>, <span class="dt">skycut=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">magzero=</span><span class="dv">30</span>, <span class="dt">pixscale=</span><span class="fl">0.34</span>, <span class="dt">plot=</span><span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psf_region=<span class="kw">matrix</span>(<span class="dv">0</span>, <span class="kw">dim</span>(image)[<span class="dv">1</span>], <span class="kw">dim</span>(image)[<span class="dv">2</span>])
psf_region[segim_expand<span class="op">$</span>segim <span class="op">%in%</span><span class="st"> </span>starlist<span class="op">$</span>segID]=<span class="dv">1</span></code></pre></div>
<p>We now need to prepare a more complicated fitting structure. We want to fit the 5 stars with the same PSF, modulo different xcen, ycen and mag:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psf_tofit2=<span class="kw">list</span>(
  <span class="dt">pointsource =</span> <span class="kw">list</span>(
    <span class="dt">xcen =</span> <span class="kw">rep</span>(<span class="ot">TRUE</span>,<span class="dv">5</span>),
    <span class="dt">ycen =</span> <span class="kw">rep</span>(<span class="ot">TRUE</span>,<span class="dv">5</span>),
    <span class="dt">mag =</span> <span class="kw">rep</span>(<span class="ot">TRUE</span>,<span class="dv">5</span>)
  ),
  <span class="dt">psf=</span><span class="kw">list</span>(
    <span class="dt">moffat=</span><span class="kw">list</span>(
      <span class="dt">mag=</span><span class="ot">FALSE</span>,
      <span class="dt">fwhm=</span><span class="ot">TRUE</span>,
      <span class="dt">con=</span><span class="ot">TRUE</span>,
      <span class="dt">axrat=</span><span class="ot">FALSE</span>,
      <span class="dt">box=</span><span class="ot">FALSE</span>
    )
  )
)

psf_tolog2=<span class="kw">list</span>(
  <span class="dt">pointsource =</span> <span class="kw">list</span>(
    <span class="dt">xcen =</span> <span class="kw">rep</span>(<span class="ot">FALSE</span>,<span class="dv">5</span>),
    <span class="dt">ycen =</span> <span class="kw">rep</span>(<span class="ot">FALSE</span>,<span class="dv">5</span>),
    <span class="dt">mag =</span> <span class="kw">rep</span>(<span class="ot">FALSE</span>,<span class="dv">5</span>)
  ),
  <span class="dt">psf=</span><span class="kw">list</span>(
    <span class="dt">moffat=</span><span class="kw">list</span>(
      <span class="dt">mag=</span><span class="ot">FALSE</span>,
      <span class="dt">fwhm=</span><span class="ot">TRUE</span>,
      <span class="dt">con=</span><span class="ot">TRUE</span>,
      <span class="dt">axrat=</span><span class="ot">TRUE</span>,
      <span class="dt">box=</span><span class="ot">TRUE</span>
    )
  )
)

psf_intervals2=<span class="kw">list</span>(
  <span class="dt">pointsource =</span> <span class="kw">list</span>(
    <span class="dt">xcen=</span><span class="kw">list</span>(starlist<span class="op">$</span>xcen[<span class="dv">1</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>), starlist<span class="op">$</span>xcen[<span class="dv">2</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>), starlist<span class="op">$</span>xcen[<span class="dv">3</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>), starlist<span class="op">$</span>xcen[<span class="dv">4</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>), starlist<span class="op">$</span>xcen[<span class="dv">5</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>)),
    <span class="dt">ycen=</span><span class="kw">list</span>(starlist<span class="op">$</span>ycen[<span class="dv">1</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>), starlist<span class="op">$</span>ycen[<span class="dv">2</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>), starlist<span class="op">$</span>ycen[<span class="dv">3</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>), starlist<span class="op">$</span>ycen[<span class="dv">4</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>), starlist<span class="op">$</span>ycen[<span class="dv">5</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>)),
    <span class="dt">mag=</span><span class="kw">list</span>(starlist<span class="op">$</span>mag[<span class="dv">1</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>), starlist<span class="op">$</span>mag[<span class="dv">2</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>), starlist<span class="op">$</span>mag[<span class="dv">3</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>), starlist<span class="op">$</span>mag[<span class="dv">4</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>), starlist<span class="op">$</span>mag[<span class="dv">5</span>]<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>))
  ),
  <span class="dt">psf=</span><span class="kw">list</span>(
    <span class="dt">moffat=</span><span class="kw">list</span>(
      <span class="dt">mag=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)),
      <span class="dt">fwhm=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>)),
      <span class="dt">con=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">10</span>)),
      <span class="dt">axrat=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>)),
      <span class="dt">box=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))
    )
  )
)</code></pre></div>
<p>From here everything is much simpler again, since we just feed our prepared objects into our setup function as per usual:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psf_Data2=<span class="kw">profitSetupData</span>(image, <span class="dt">sigma=</span>sigma, <span class="dt">modellist=</span>psf_modellist2, <span class="dt">tofit=</span>psf_tofit2, <span class="dt">tolog=</span>psf_tolog2, <span class="dt">magzero=</span><span class="dv">30</span>, <span class="dt">algo.func=</span><span class="st">'optim'</span>, <span class="dt">intervals=</span>psf_intervals2, <span class="dt">region=</span>psf_region)</code></pre></div>
<p>We check the initial guess. Notice the three stars are visible as the three circled regions. Given the image scale it is a bit tricky to see how good our initial guesses actually were, but probably not too bad.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">profitLikeModel</span>(<span class="dt">parm=</span>psf_Data2<span class="op">$</span>init, <span class="dt">Data=</span>psf_Data2, <span class="dt">makeplots=</span><span class="ot">TRUE</span>, <span class="dt">plotchisq=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>So like before, not bad, but not perfect. We can do an optim fit to improve things:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psf_fit2=<span class="kw">optim</span>(psf_Data2<span class="op">$</span>init, profitLikeModel, <span class="dt">method=</span><span class="st">'BFGS'</span>, <span class="dt">Data=</span>psf_Data2, <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">fnscale=</span><span class="op">-</span><span class="dv">1</span>))</code></pre></div>
<p>Now we plot the output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">profitLikeModel</span>(<span class="dt">parm=</span>psf_fit2<span class="op">$</span>par, <span class="dt">Data=</span>psf_Data2, <span class="dt">makeplots=</span><span class="ot">TRUE</span>, <span class="dt">plotchisq=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>Maybe useful to zoom in a bit:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psf_modellist_fit2=<span class="kw">profitRemakeModellist</span>(<span class="dt">parm=</span>psf_fit2<span class="op">$</span>par, <span class="dt">Data=</span>psf_Data2)<span class="op">$</span>modellist
psf_model_full2=<span class="kw">profitMakeModel</span>(psf_modellist_fit2,<span class="dt">dim=</span><span class="kw">dim</span>(image),<span class="dt">magzero=</span><span class="dv">30</span>)<span class="op">$</span>z
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){
  <span class="kw">magimage</span>(<span class="kw">magcutout</span>(image, <span class="dt">loc=</span>starlist[i,<span class="kw">c</span>(<span class="st">'xcen'</span>,<span class="st">'ycen'</span>)], <span class="dt">box=</span><span class="kw">c</span>(<span class="dv">51</span>,<span class="dv">51</span>))<span class="op">$</span>image, <span class="dt">col=</span><span class="kw">rev</span>(<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;RdYlBu&quot;</span>))(<span class="dv">100</span>)), <span class="dt">magmap=</span><span class="ot">FALSE</span>, <span class="dt">zlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">2e2</span>,<span class="fl">2e2</span>))
  <span class="kw">magimage</span>(<span class="kw">magcutout</span>(image<span class="op">-</span>psf_model_full2, <span class="dt">loc=</span>starlist[i,<span class="kw">c</span>(<span class="st">'xcen'</span>,<span class="st">'ycen'</span>)], <span class="dt">box=</span><span class="kw">c</span>(<span class="dv">51</span>,<span class="dv">51</span>))<span class="op">$</span>image, <span class="dt">col=</span><span class="kw">rev</span>(<span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;RdYlBu&quot;</span>))(<span class="dv">100</span>)), <span class="dt">magmap=</span><span class="ot">FALSE</span>, <span class="dt">zlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">2e2</span>,<span class="fl">2e2</span>))
}</code></pre></div>
<p>This looks like a very good fit. We will now contruct our model PSF:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">psf_modellist_fit2<span class="op">$</span>psf<span class="op">$</span>moffat<span class="op">$</span>xcen=<span class="dv">25</span><span class="op">/</span><span class="dv">2</span>
psf_modellist_fit2<span class="op">$</span>psf<span class="op">$</span>moffat<span class="op">$</span>ycen=<span class="dv">25</span><span class="op">/</span><span class="dv">2</span>
psf_model2=<span class="kw">profitMakeModel</span>(<span class="dt">modellist=</span>psf_modellist_fit2<span class="op">$</span>psf, <span class="dt">magzero=</span><span class="dv">30</span>, <span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">25</span>,<span class="dv">25</span>))<span class="op">$</span>z</code></pre></div>
<p>And now we can look at our final PSF model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">magimage</span>(psf_model2)</code></pre></div>
</div>
</div>
<div id="fitting-the-target-galaxy-with-profit" class="section level2">
<h2>Fitting the Target Galaxy with ProFit</h2>
<p>Much like we did with the PSF fit, we have to extract the region of interest and setup our fitting structures:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gal_image=<span class="kw">magcutout</span>(image, <span class="dt">loc=</span>segim_expand<span class="op">$</span>segstats[<span class="dv">6</span>,<span class="kw">c</span>(<span class="st">'xcen'</span>,<span class="st">'ycen'</span>)], <span class="dt">box=</span><span class="kw">c</span>(<span class="dv">101</span>,<span class="dv">101</span>))
gal_sigma=<span class="kw">magcutout</span>(sigma, <span class="dt">loc=</span>segim_expand<span class="op">$</span>segstats[<span class="dv">6</span>,<span class="kw">c</span>(<span class="st">'xcen'</span>,<span class="st">'ycen'</span>)], <span class="dt">box=</span><span class="kw">c</span>(<span class="dv">101</span>,<span class="dv">101</span>))
gal_segim=<span class="kw">magcutout</span>(segim_expand<span class="op">$</span>segim, <span class="dt">loc=</span>segim_expand<span class="op">$</span>segstats[<span class="dv">6</span>,<span class="kw">c</span>(<span class="st">'xcen'</span>,<span class="st">'ycen'</span>)], <span class="dt">box=</span><span class="kw">c</span>(<span class="dv">101</span>,<span class="dv">101</span>))</code></pre></div>
<p>Check the cutout regions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">magimage</span>(gal_image<span class="op">$</span>image)
<span class="kw">magimage</span>(gal_sigma<span class="op">$</span>image)
<span class="kw">magimage</span>(gal_segim<span class="op">$</span>image)</code></pre></div>
<p>As before, we have to setup some reasonable guesses for our galaxy fit. We give it a very faint initial bulge since we can tell it is a very disky system and we are only using a simple optimiser so we do not want it to get stuck in an odd local minima with a massive bulge. To do this properly and with psychic inputs you would use a better optimiser (e.g.Â full MCMC or genetic algorithm).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gal_x=gal_image<span class="op">$</span>loc[<span class="dv">1</span>]
gal_y=gal_image<span class="op">$</span>loc[<span class="dv">2</span>]
gal_mag=segim_expand<span class="op">$</span>segstats[<span class="dv">6</span>,<span class="st">'mag'</span>]
gal_re=segim_expand<span class="op">$</span>segstats[<span class="dv">6</span>,<span class="st">'R50'</span>]<span class="op">/</span><span class="fl">0.339</span>
gal_ang=segim_expand<span class="op">$</span>segstats[<span class="dv">6</span>,<span class="st">'ang'</span>]
gal_axrat=segim_expand<span class="op">$</span>segstats[<span class="dv">6</span>,<span class="st">'axrat'</span>]

gal_modellist=<span class="kw">list</span>(
  <span class="dt">sersic=</span><span class="kw">list</span>(
    <span class="dt">xcen=</span><span class="kw">rep</span>(gal_x,<span class="dv">2</span>),
    <span class="dt">ycen=</span><span class="kw">rep</span>(gal_y,<span class="dv">2</span>),
    <span class="dt">mag=</span><span class="kw">rep</span>(gal_mag,<span class="dv">2</span>)<span class="op">+</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="fl">0.7</span>),
    <span class="dt">re=</span><span class="kw">c</span>(gal_re<span class="op">/</span><span class="dv">4</span>,gal_re),
    <span class="dt">nser=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>),
    <span class="dt">ang=</span><span class="kw">c</span>(<span class="dv">0</span>,gal_ang),
    <span class="dt">axrat=</span><span class="kw">c</span>(<span class="dv">1</span>,gal_axrat),
    <span class="dt">box=</span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>)
  )
)</code></pre></div>
<p>And now we make the other inputs we need for our fitting <strong>Data</strong> structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gal_tofit=<span class="kw">list</span>(
  <span class="dt">sersic=</span><span class="kw">list</span>(
    <span class="dt">xcen=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">NA</span>), <span class="co">#We fit for xcen and tie the two togther</span>
    <span class="dt">ycen=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">NA</span>), <span class="co">#We fit for ycen and tie the two togther</span>
    <span class="dt">mag=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="co">#Fit for both</span>
    <span class="dt">re=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="co">#Fit for both</span>
    <span class="dt">nser=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>), <span class="co">#Fit for neither</span>
    <span class="dt">ang=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">TRUE</span>), <span class="co">#Fit for disk</span>
    <span class="dt">axrat=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">TRUE</span>), <span class="co">#Fit for disk</span>
    <span class="dt">box=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>) <span class="co">#Fit for neither</span>
  )
)

gal_tolog=<span class="kw">list</span>(
  <span class="dt">sersic=</span><span class="kw">list</span>(
    <span class="dt">xcen=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>),
    <span class="dt">ycen=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>),
    <span class="dt">mag=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>),
    <span class="dt">re=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="co">#re is best fit in log space</span>
    <span class="dt">nser=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="co">#nser is best fit in log space</span>
    <span class="dt">ang=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>),
    <span class="dt">axrat=</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="co">#axrat is best fit in log space</span>
    <span class="dt">box=</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">FALSE</span>)
  )
)

gal_intervals=<span class="kw">list</span>(
  <span class="dt">sersic=</span><span class="kw">list</span>(
    <span class="dt">xcen=</span><span class="kw">list</span>(<span class="dt">lim=</span>gal_x<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="dt">lim=</span>gal_x<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>)),
    <span class="dt">ycen=</span><span class="kw">list</span>(<span class="dt">lim=</span>gal_y<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>),gal_y<span class="op">+</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>)),
    <span class="dt">mag=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">30</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">30</span>)),
    <span class="dt">re=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">100</span>)),
    <span class="dt">nser=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">20</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">20</span>)),
    <span class="dt">ang=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">360</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>,<span class="dv">360</span>)),
    <span class="dt">axrat=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="fl">0.001</span>,<span class="dv">1</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="fl">0.001</span>,<span class="dv">1</span>)),
    <span class="dt">box=</span><span class="kw">list</span>(<span class="dt">lim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">lim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))
  )
)</code></pre></div>
<p>Now we can set up our full fitting structure with averything we have made (notice we use our simpler PSF model here):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gal_Data=<span class="kw">profitSetupData</span>(gal_image<span class="op">$</span>image, <span class="dt">sigma=</span>gal_sigma<span class="op">$</span>image, <span class="dt">modellist=</span>gal_modellist, <span class="dt">tofit=</span>gal_tofit, <span class="dt">tolog=</span>gal_tolog, <span class="dt">magzero=</span><span class="dv">30</span>, <span class="dt">algo.func=</span><span class="st">'optim'</span>, <span class="dt">intervals=</span>gal_intervals, <span class="dt">psf=</span>psf_model, <span class="dt">segim=</span>gal_segim<span class="op">$</span>image)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">profitLikeModel</span>(<span class="dt">parm=</span>gal_Data<span class="op">$</span>init, <span class="dt">Data=</span>gal_Data, <span class="dt">makeplots=</span><span class="ot">TRUE</span>, <span class="dt">plotchisq=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>Not a bad start, but certainly not great. Letâs do an optim fit:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gal_fit=<span class="kw">optim</span>(gal_Data<span class="op">$</span>init, profitLikeModel, <span class="dt">method=</span><span class="st">'BFGS'</span>, <span class="dt">Data=</span>gal_Data, <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">fnscale=</span><span class="op">-</span><span class="dv">1</span>))</code></pre></div>
<p>We can now recreate our optimised <strong>modellist</strong>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gal_fit_modellist=<span class="kw">profitRemakeModellist</span>(gal_fit<span class="op">$</span>par, <span class="dt">Data=</span>gal_Data)<span class="op">$</span>modellist
<span class="kw">print</span>(gal_fit_modellist)</code></pre></div>
<p>And we can then plot the output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">profitLikeModel</span>(<span class="dt">parm=</span>gal_fit<span class="op">$</span>par, <span class="dt">Data=</span>gal_Data, <span class="dt">makeplots=</span><span class="ot">TRUE</span>, <span class="dt">plotchisq=</span><span class="ot">TRUE</span>)
<span class="kw">profitEllipsePlot</span>(<span class="dt">Data=</span>gal_Data, <span class="dt">modellist=</span>gal_fit_modellist, <span class="dt">pixscale=</span><span class="fl">0.34</span>, <span class="dt">SBlim=</span>SBlim)</code></pre></div>
<p>This looks pretty good!</p>
</div>
<div id="conclusions" class="section level2">
<h2>Conclusions</h2>
<p>So there we have it- using image pixel data and no header information except for the magnitude zero-point (which we can always calibrate later by matching to known sources) we have managed to achieve a very reasonable looking galaxy fit in a complex region with bright nearby contaminating sources. Our full chain of work was:</p>
<ol style="list-style-type: decimal">
<li>Load in the <strong>image</strong> data</li>
<li>Make a segmentation map (<strong>segim</strong>), which also estimates sky properties (<strong>profitMakeSegim</strong> and <strong>profitMakeSegimExpand</strong>)</li>
<li>Calculate the likely elec/ADU gain of the image (<strong>profitGainEst</strong>)</li>
<li>Make a <strong>sigma</strong> map (<strong>profitMakeSigma</strong>)</li>
<li>Find a subset of likely stars, and extract the brightest one</li>
<li>Fit a Moffat profile to this bright star and generate a model PSF</li>
<li>Cut down our data to the region around the galaxy of interest</li>
<li>Estimate initial B/D parameters from the segimentation map statistics</li>
<li>Using all of the data created (including the new PSF) fit an exponential disk + de-Vaucouleurs bulge profile</li>
</ol>
<p>Nearly all of the above can be automated for user data of interest, and should act as a good outline of how you can use <strong>ProFit</strong> to fit a range of data where not all of the meta information is to hand.</p>
<p>For various reasons users might get better results from using, e.g., SExtractor as part of their processing pipeline rather than the internal utility functions, but there should be enough to get you going on your virtuous path of galaxy fitting ;-)</p>
<p>In all of this, the biggest gotcha is no doubt achieving a decent estimate of the PSF. Here we fit to a single star using a Moffat function, but with HST data you will almost certainly need to use Tiny-Tim, and many people advocate using shapelet fitting programs like PSF-Ex and their ilk.</p>
<p>For space derived data you probably do want to use tools provided by the relevant facility, but for most ground imaging better results can be achieved through fitting analytic models to stars near your target galaxy (ideally multiple stars, so you can reject bad fits etc.) and constructing an idealised PSF from the analytic model. If you are feeling <em>really</em> adventurous you could even marginalise over your uncertainty in the PSF by re-doing your fit with samples from the PSF model posterior.</p>
<p>The other parts of the process mentioned above are much more straight-forward, and there are lots of routes (including the above) that will give you decent results. In my experience when things go badly wrong (a few percent of the time when trying to fully automate all of this) the main culprit is bad segmentation due to nearby very bright stars. In these situations you probably should not be trying to achieve a good fit given the data quality. Issues with the sigma maps going wrong are easily spotted when looking at the error residuals for a good fit- the main culprit here will usually be a mistake in the gain (e.g.Â using inverse gain as gain). Remember: image ADUs x gain = image photo-electrons! If really unsure use the provided <strong>profitGainEst</strong> function to sanity check your value.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
